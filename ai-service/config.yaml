# =====================================================
# AI People Counting Service - Configuration
# =====================================================

service:
  # YOLOv8 Model (yolov8n.pt = เล็ก/เร็ว, yolov8s.pt = กลาง, yolov8m.pt = ใหญ่/แม่น)
  model: "yolov8n.pt"
  
  # Device: "cuda" สำหรับ GPU, "cpu" สำหรับ CPU
  device: "cpu"
  
  # Confidence threshold (0.0 - 1.0)
  confidence: 0.4
  
  # เปิดใช้ Tracker เพื่อลด flicker
  tracker: true
  
  # Frame rate ที่จะประมวลผล (fps)
  default_sampling_fps: 1.0
  
  # ส่งข้อมูลไป Backend ทุกกี่วินาที
  send_interval_s: 5
  
  # Smoothing window size
  smoothing_window: 5
  
  # Backend API
  backend_endpoint: "https://forlp-production.up.railway.app/api/ai/people-count"
  backend_api_key: "kadkongta-ai-secret-2024"
  
  # Prometheus metrics port
  metrics_port: 8080

# =====================================================
# Playback Mode Configuration
# วิเคราะห์วิดีโอย้อนหลังแทน Realtime
# =====================================================
playback:
  # เปิดใช้ Playback Mode
  enabled: true
  
  # go2rtc Server URL สำหรับ Playback API
  go2rtc_base_url: "https://iocpiramid.com:8085"
  
  # ความยาว window ที่จะวิเคราะห์ (นาที)
  window_duration_minutes: 1
  
  # ดึงย้อนหลังจากปัจจุบันกี่นาที (delay)
  delay_minutes: 1
  
  # ทำซ้ำทุกกี่นาที
  interval_minutes: 2
  
  # Sample กี่ frame ต่อวินาที (ลดภาระ inference)
  # ลดจาก 0.5 เป็น 0.33 เพื่อดึง ~20 frames แทน 30 (ลด timeout)
  sampling_fps: 0.33
  
  # Timeout สำหรับการดึงวิดีโอ (วินาที)
  # เพิ่มจาก 60 เป็น 90 เพื่อให้มีเวลาดึง frames มากขึ้น
  timeout_seconds: 90
  
  # ตรวจสอบ SSL certificate หรือไม่
  verify_ssl: false

# =====================================================
# go2rtc Server Configuration
# =====================================================
go2rtc:
  enabled: false
  server_url: "https://iocpiramid.com:8085"
  use_snapshot: false
  timeout: 10
  verify_ssl: false
  auto_discover: true

# =====================================================
# Hikvision Direct API Configuration
# =====================================================
hikvision:
  enabled: true
  timeout: 10
  verify_ssl: false

# =====================================================
# Camera Streams
# =====================================================
streams:
  - stream_id: "camera-1"
    go2rtc_stream: "test1"
    rtsp: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.4:554/Streaming/Channels/201"
    snapshot_url: "http://10.0.10.4/ISAPI/Streaming/channels/201/picture"
    snapshot_auth:
      username: "admin"
      password: "P1r@m1dnvrLpg"
    sampling_fps: 1.0
    tracker: true
    send_interval_s: 5
    confidence: 0.4

  - stream_id: "camera-2"
    go2rtc_stream: ""
    rtsp: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.3:554/Streaming/Channels/201"
    snapshot_url: "http://10.0.10.3/ISAPI/Streaming/channels/201/picture"
    snapshot_auth:
      username: "admin"
      password: "P1r@m1dnvrLpg"
    sampling_fps: 1.0
    tracker: true
    send_interval_s: 5
    confidence: 0.4

# =====================================================
# Camera Configuration สำหรับ Playback Mode
# =====================================================
cameras:
  # LPG-A01-CC-01 ตลาดกาดกองต้า (PTZ)
  - camera_id: "LPG-A01-CC-01"
    name: "ตลาดกาดกองต้า (PTZ)"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.4:554/Streaming/Channels/201"
    rtsp_ip: "10.0.10.4"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "201"
    confidence: 0.4
    enabled: true

  # LPG-A01-CC-02 ตลาดกาดกองต้า
  - camera_id: "LPG-A01-CC-02"
    name: "ตลาดกาดกองต้า"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.3:554/Streaming/Channels/201"
    rtsp_ip: "10.0.10.3"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "201"
    confidence: 0.4
    enabled: true

  # LPG-B01-CC-01 ตลาดกาดกองต้า 1 ฝั่งสะพานรัษฎา
  - camera_id: "LPG-B01-CC-01"
    name: "ตลาดกาดกองต้า 1 ฝั่งสะพานรัษฎา"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.3:554/Streaming/Channels/301"
    rtsp_ip: "10.0.10.3"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "301"
    confidence: 0.4
    enabled: true

  # LPG-B01-CC-02 ตลาดกาดกองต้า 1 ฝั่งสะพานรัษฎา (PTZ)
  - camera_id: "LPG-B01-CC-02"
    name: "ตลาดกาดกองต้า 1 ฝั่งสะพานรัษฎา (PTZ)"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.4:554/Streaming/Channels/401"
    rtsp_ip: "10.0.10.4"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "401"
    confidence: 0.4
    enabled: true

  # LPG-B02-CC-01 ตลาดกาดกองต้า 2 ตลาดเก่า
  - camera_id: "LPG-B02-CC-01"
    name: "ตลาดกาดกองต้า 2 ตลาดเก่า"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.3:554/Streaming/Channels/501"
    rtsp_ip: "10.0.10.3"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "501"
    confidence: 0.4
    enabled: true

  # LPG-B02-CC-02 ตลาดกาดกองต้า 2 ตลาดเก่า
  - camera_id: "LPG-B02-CC-02"
    name: "ตลาดกาดกองต้า 2 ตลาดเก่า"
    rtsp_url: "rtsp://admin:P1r@m1dnvrLpg@10.0.10.3:554/Streaming/Channels/601"
    rtsp_ip: "10.0.10.3"
    rtsp_port: 554
    rtsp_username: "admin"
    rtsp_password: "P1r@m1dnvrLpg"
    track_id: "601"
    confidence: 0.4
    enabled: true

# =====================================================
# Location (พิกัด GPS)
# =====================================================
location:
  name: "Lampang Smart City - กาดกองต้า"
  latitude: 18.288884
  longitude: 99.489194
